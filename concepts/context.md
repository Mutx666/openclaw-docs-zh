# 上下文 (Context)

“上下文”是 OpenClaw 在每次运行时发送给模型的所有信息的总和。它受到模型 Token 限制的约束。

## 上下文的组成部分
1. **系统提示词 (System Prompt)**：由 OpenClaw 构建，包含规则、工具列表、技能列表、时间/运行时信息以及注入的工作空间文件。
2. **对话历史**：当前会话中你和 Agent 的所有历史消息。
3. **工具调用与结果**：命令输出、读取的文件内容、图像/音频等。

## 常用查看命令
- **/status**：快速查看“我的窗口有多满”以及当前会话设置。
- **/context list**：列出当前注入的所有文件及其大致大小。
- **/context detail**：更深入的细分，包括单个工具的 Schema 大小、系统提示词大小等。
- **/usage tokens**：在每条回复后附带 Token 使用情况。

## 注入的工作空间文件 (Project Context)
OpenClaw 默认会注入以下文件（如果存在）：
- \`AGENTS.md\`, \`SOUL.md\`, \`TOOLS.md\`, \`IDENTITY.md\`, \`USER.md\`, \`HEARTBEAT.md\`。
- **截断机制**：超大文件会根据 \`agents.defaults.bootstrapMaxChars\`（默认 20,000 字符）进行截断。

## 技能与工具的成本
- **技能**：系统提示词中只包含技能的元数据（名称和描述）。具体的 \`SKILL.md\` 内容仅在 Agent 需要时才会按需读取。
- **工具**：工具不仅占用系统提示词的文本行，还包括发送给模型的 **JSON Schema**。即使你看不见 JSON 代码，它依然会占用大量的 Token。

## 上下文、压缩与剪裁
- **对话历史**：持久化保存在 JSONL 记录中。
- **压缩 (Compaction)**：将旧历史总结为摘要条目，释放窗口空间并持久化。
- **剪裁 (Pruning)**：仅在内存中剔除旧的工具执行结果，不改写磁盘历史。
