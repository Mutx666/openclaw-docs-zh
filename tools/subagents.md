# 子代理 (Sub-Agents)

子代理是由当前 Agent 派生的后台运行进程。它们运行在独立的会话中，并在完成后自动将结果汇报给主 Agent 所在的聊天频道。

## 核心目的
- **并行处理**：在不阻塞当前聊天的情况下，处理耗时任务（如深入调研、大规模代码分析）。
- **资源隔离**：子代理拥有独立的上下文，不会污染主会话的历史记录。
- **成本控制**：可以为子代理配置更廉价的模型（如 \`gpt-4o-mini\`），而主 Agent 使用高质量模型。

## 常用命令 (CLI)
- **/subagents list**：列出当前活跃的所有子代理。
- **/subagents stop**：停止所有运行中的子代理。
- **/subagents log**：查看特定子代理的运行日志。

## Agent 工具：\`sessions_spawn\`
Agent 可以通过此工具“召唤”一个助手：
- **task** (必填)：分配给子代理的具体任务。
- **label**：为助手起个名字（方便日志识别）。
- **model**：指定助手使用的模型。
- **cleanup**：任务结束后是否立即删除临时会话记录。

## 运行机制
1. **自动汇报 (Announce)**：子代理运行结束后，系统会自动在主聊天频道发布一条摘要，包含任务状态、结果和 Token 消耗统计。
2. **工具限制**：默认情况下，子代理无法再次派生子代理（防止无限循环），且无法直接控制网关配置。
3. **自动归档**：闲置 60 分钟后，子代理会话会自动归档以释放空间。

## 并发控制
默认情况下，系统允许同时运行 8 个子代理（可通过 \`agents.defaults.subagents.maxConcurrent\` 调整）。
